import numpy as np

class GramianAngularField:

    def __init__(self, op = 'dif', trig = np.sen, series = [], I = [0, 1]):
        """
        Generates an angular field, for a given operator (dif or sum), for a given trigonometric function.
        :param op: operator of the field (pred dif)
        :param f: function (pred np.sen)
        :param series: time series to compute the gramian angular field
        :param I: interval of normalization of the time series
        :return: matricial representation of the gramian angular field
        """
        op_allowed = ('dif', 'sum')
        f_allowed = (np.sen, np.cos)
        if op not in op_allowed or f not in f_allowed:
            raise ValueError("Not allowed params. Operation must be summation ('sum') or difference ('dif'). Trigonometric function \
                must be np.sen or np.cos")
        self.__op = op
        self.__trig = trig
        m = min(series)
        M = max(series)
        a, b = I
        rescaled = [a + (i - m)*(b-a)/(M - m) for i in series]
        angles = [np.arccos(i) for i in rescaled]
        g = np.array([[f(i - j) if op == 'dif' else f(i + j) for j in angles] for i in angles])
        self.__datastructure = g
    @property
    def matrix():
        return self.__datastructure
    @property
    def op_type():
        return self.__op
    @property
    def function():
        return self.__trig
        